:root {
  --bg-app: #fcfaf7;
  --sidebar: #f1ede6;
  --text: #5c4b40;
  --accent: #e29a9a;
  --shadow: 0 10px 40px rgba(0,0,0,0.04);
  /* สี Priority สำหรับขอบ Card */
  --prio-high: #ff9d9d;
  --prio-med: #ffd8a8;
  --prio-low: #e0e0e0;
}

.night-theme {
  --bg-app: #2d2416;
  --sidebar: #3d3227;
  --text: #e8dcc8;
  --accent: #d4a574;
  --prio-high: #e8947c;
  --prio-med: #d9b987;
  --prio-low: #a89878;
}

* { box-sizing: border-box; }

/* --- Layout --- */
.app-layout { 
  display: flex; 
  height: 100vh; 
  padding: 12px; 
  gap: 12px; 
  background-color: var(--bg-app); 
  transition: 0.5s; 
  overflow: hidden; 
}

/* --- Sidebar: ล็อคกึ่งกลางเป๊ะ --- */
.sidebar {
  width: 260px;
  background-color: var(--sidebar);
  border-radius: 32px;
  display: flex;
  flex-direction: column;
  transition: width 0.4s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  flex-shrink: 0;
  box-shadow: var(--shadow);
}

.sidebar-collapsed .sidebar { width: 88px; }

.sidebar-container {
  display: flex;
  flex-direction: column;
  height: 100%;
  padding: 20px 0;
  align-items: center;
}

.sidebar-header {
  display: flex;
  align-items: center;
  justify-content: center;
  margin-bottom: 5px;
  width: 100%;
  padding-top: 10px;
}
.sidebar-expanded .sidebar-header { justify-content: flex-start; padding: 0 5px; }

.logo-section { 
  display: flex; 
  align-items: center; 
  gap: 12px; 
  cursor: pointer; 
  justify-content: center;
  width: 54px;
  height: 54px;
  box-sizing: border-box;
}

.sidebar-expanded .logo-section { width: calc(100% - 24px); justify-content: flex-start; padding: 0 12px; box-sizing: border-box; }

.logo-emoji { font-size: 1.4rem; min-width: 24px; width: 24px; display: flex; align-items: center; justify-content: center; }

.brand-name { font-weight: 800; font-size: 1.1rem; color: var(--text); white-space: nowrap; }

/* ปุ่ม Toggle ลอยตัว */
.sidebar-float-toggle {
  background: white; 
  border: 1px solid #e5e0d8; 
  border-radius: 50%;
  width: 26px; 
  height: 26px; 
  cursor: pointer;
  position: absolute; 
  right: -13px; 
  top: 42px; 
  z-index: 50;
  display: flex; 
  align-items: center; 
  justify-content: center; 
  box-shadow: 0 2px 8px rgba(0,0,0,0.06);
}

.chevron { width: 6px; height: 6px; border-top: 2px solid #888; border-right: 2px solid #888; transition: 0.3s; }
.chevron.left { transform: rotate(-135deg); margin-left: 2px; }
.chevron.right { transform: rotate(45deg); margin-right: 2px; }

/* --- Nav Items --- */
.nav-list-cozy { 
  margin-top: 0 !important;
  padding-top: 0;
  width: 100%; 
  display: flex; 
  flex-direction: column; 
  align-items: center; 
  gap: 2px;
}

.nav-item-pill {
  display: flex; 
  align-items: center; 
  padding: 14px 20px; 
  margin-bottom: 8px;
  border-radius: 20px; 
  cursor: pointer; 
  transition: 0.3s; 
  color: var(--text);
  width: calc(100% - 24px); 
  gap: 15px; 
  box-sizing: border-box;
  height: 54px;
}

.sidebar-collapsed .nav-item-pill { justify-content: center; width: 54px; padding: 0; height: 54px; }
.nav-item-pill.active { background: white; box-shadow: 0 4px 15px rgba(0,0,0,0.03); font-weight: 700; }
.icon { font-size: 1.4rem; min-width: 24px; width: 24px; display: flex; align-items: center; justify-content: center; }

/* Garden Status */
.sidebar-footer-garden { 
  margin-top: auto; 
  width: 100%; 
  display: flex; 
  flex-direction: column; 
  align-items: center; 
  gap: 10px; 
  padding-bottom: 20px; 
}
.garden-status-pill {
  background: rgba(255,255,255,0.4); 
  padding: 0 42px;
  border-radius: 24px;
  display: flex; 
  align-items: center; 
  justify-content: center;
  gap: 12px; 
  width: calc(100% - 24px); 
  box-sizing: border-box;
  height: 50px;
}
.sidebar-collapsed .garden-status-pill { 
  justify-content: center; 
  width: 54px; 
  height: 54px; 
  padding: 0; 
  display: none; 
}
.sidebar-expanded .garden-status-pill { 
  justify-content: flex-start; 
}

.garden-icon { 
  font-size: 1.4rem; 
  min-width: 24px; 
  width: 24px; 
  display: flex; 
  align-items: center; 
  justify-content: center; 
}

.del-btn-pill {
  background: #fafafa; 
  border: 1px solid #eee; 
  color: #bbb;
  padding: 6px 14px; 
  border-radius: 20px; /* มนทรงแคปซูล */
  cursor: pointer; 
  font-size: 0.8rem; 
  transition: 0.2s;
  font-family: inherit;
}
.del-btn-pill:hover { background: #fee; color: var(--accent); border-color: var(--accent); }

.date-picker-soft {
  border: 1px solid #eee; 
  background: #fafafa; 
  border-radius: 14px; /* มนเท่าปุ่มอารมณ์ */
  padding: 8px 12px; 
  font-family: inherit; 
  color: var(--text);
  outline: none; 
  cursor: pointer; 
  transition: 0.2s;
  height: 44px;
}
.date-picker-soft:focus { border-color: var(--accent); background: white; }

/* --- Pill Selectors: แสดงสถานะที่เลือก --- */
.pill-selector { display: flex; gap: 8px; background: rgba(0,0,0,0.03); padding: 6px; border-radius: 16px; }
.pill-btn { border: none; background: transparent; padding: 8px 18px; border-radius: 12px; cursor: pointer; font-size: 0.9rem; transition: 0.2s; font-family: inherit; }

.active-low { background: #e8f5e9; color: #4caf50; font-weight: bold; }
.active-medium { background: #fff3e0; color: #ff9800; font-weight: bold; }
.active-high { background: #ffebee; color: #f44336; font-weight: bold; }
.active-diary { background: var(--accent); color: white; }
.active-letter { background: #c6b5e8; color: white; }

/* --- To-Do Cards with Priority Borders --- */
.item-card.border-high { border-left: 8px solid var(--prio-high); }
.item-card.border-medium { border-left: 8px solid var(--prio-med); }
.item-card.border-low { border-left: 8px solid var(--prio-low); }

/* --- Main Content --- */
.main-content { flex: 1; background: white; border-radius: 32px; overflow: hidden; display: flex; flex-direction: column; box-shadow: var(--shadow); }
.cover-box { height: 260px; overflow: hidden; }
.cover-img { width: 100%; height: 100%; object-fit: cover; }
.scroll-area { flex: 1; overflow-y: auto; padding: 40px 10% 80px 10%; }

/* --- Scrollbar มนๆ --- */
.scroll-area::-webkit-scrollbar { 
  width: 8px; }
.scroll-area::-webkit-scrollbar-thumb { background: #eee; border-radius: 10px; }

.cozy-card { background: #fff; border: 1px solid rgba(0,0,0,0.04); border-radius: 28px; padding: 24px; margin-bottom: 30px; }
.full-input { width: 100%; border: none; background: #fafafa; padding: 18px; border-radius: 18px; outline: none; font-size: 1.1rem; margin-bottom: 15px; font-family: inherit; }

.input-row {
  display: flex;
  gap: 12px;
  align-items: center;
  margin-bottom: 15px;
}

.input-row .full-input {
  flex: 1;
  margin-bottom: 0;
}

.input-row .action-btn-main {
  flex-shrink: 0;
  padding: 16px 28px;
  white-space: nowrap;
}

.date-row {
  display: flex;
  gap: 12px;
  margin-bottom: 15px;
}

.date-input {
  flex: 1;
  border: none;
  background: #fafafa;
  padding: 12px 16px;
  border-radius: 14px;
  font-family: inherit;
  font-size: 0.95rem;
  color: var(--text);
  outline: none;
  cursor: pointer;
  transition: 0.2s;
}

.date-label { display: flex; flex-direction: column; gap: 6px; flex: 1; }
.date-label-text { font-size: 0.85rem; color: #6b5e53; font-weight: 600; }

.date-input:focus {
  background: white;
  border: 1px solid var(--accent);
}

.action-btn-main, .action-btn-save { 
  background: var(--accent); 
  color: white; 
  border: none; 
  padding: 12px 24px; 
  border-radius: 14px; 
  font-weight: 700; 
  cursor: pointer; 
  transition: 0.2s; 
}
.action-btn-main:hover { transform: translateY(-2px); filter: brightness(1.05); }

.item-card, .journal-card { padding: 20px; border-radius: 22px; border: 1px solid rgba(0,0,0,0.02); margin-bottom: 12px; background: #fff; display: flex; justify-content: space-between; align-items: flex-start; position: relative; }

/* For journals in grid: center content */
.items-list .journal-card {
  flex-direction: column;
  align-items: center;
  text-align: center;
  justify-content: flex-start;
  min-height: 130px;
  margin-bottom: 0;
  padding: 16px;
  border: 2px solid rgba(0,0,0,0.12);
  order: 1;
}

.item-card.editing { background: #fffbf0; border: 2px solid var(--accent); }

.item-actions {
  display: flex;
  gap: 4px;
  flex-shrink: 0;
  position: absolute;
  top: 12px;
  right: 12px;
}

.item-actions-edit {
  display: flex;
  gap: 6px;
  flex-shrink: 0;
  position: absolute;
  top: 12px;
  right: 12px;
}

.icon-btn {
  background: none;
  border: none;
  font-size: 0.9rem;
  cursor: pointer;
  padding: 4px 6px;
  transition: 0.2s;
  display: flex;
  align-items: center;
  justify-content: center;
}

.edit-btn:hover {
  transform: scale(1.15);
}

.delete-btn:hover {
  transform: scale(1.15);
}

.save-btn, .cancel-btn {
  font-size: 0.85rem;
  padding: 4px 6px;
}

.save-btn:hover {
  transform: scale(1.1);
}

.cancel-btn {
  font-size: 1rem;
}

.cancel-btn:hover {
  transform: scale(1.1);
}

/* Journal delete icon (top-right) */
.journal-card { position: relative; }
.journal-actions {
  position: absolute;
  top: 10px;
  right: 10px;
  display: flex;
  gap: 6px;
}
.journal-actions .icon-btn {
  font-size: 0.9rem;
  padding: 4px 6px;
}

.mail-icon-top {
  display: flex;
  justify-content: center;
  align-items: center;
  width: auto;
  height: auto;
  margin: 0 !important;  /* ลบ margin ที่อาจทำให้เบี้ยวออก */
  padding: 0 !important;  /* ลบ padding ที่อาจทำให้เบี้ยวออก */
  font-size: 3.5rem;      /* ปรับขนาดซองจดหมายตามต้องการ */
  background: none;
  border: none;
  cursor: pointer;
  line-height: 1;         /* ช่วยให้ emoji อยู่ตรงกลางพื้นที่ของมัน */
}
/* Centered, smaller, faded journal content */
.card-top { 
  display: flex; 
  flex-direction: column; /* เปลี่ยนให้เรียงจากบนลงล่าง */
  justify-content: center;
  align-items: center; 
  gap: 10px;        /* ระยะห่างระหว่างซองจดหมายกับบรรทัดวันที่ */
  min-height: 100px; /* รีเซ็ตค่าความสูงเดิม */
  padding: 15px 12px 5px 12px; 
  position: relative;
}

/* For grid journal cards: simplify card-top */
.items-list .journal-card .card-top {
  position: relative;
  justify-content: center;
  align-items: center;
  min-height: auto;
  width: 100%;
  flex-direction: column;
  padding: 0;
}

.card-top-right {
  display: flex;
  align-items: center;
  gap: 8px;
  position: absolute;
  right: 12px;
  top: 50%;
  transform: translateY(-50%);
  z-index: 14;
}


/* For grid: position mail icon in center */
.items-list .journal-card .mail-icon-top {
  position: relative;
  left: auto;
  top: auto;
  transform: none;
  z-index: 1;
  margin-bottom: 16px;
  font-size: 3.2rem;
  width: 72px;
  height: 72px;
  order: 2;
}

.card-date { font-size: 0.9rem; color: rgba(0,0,0,0.6); }

/* Show mood emoji in grid view */
.items-list .journal-card .card-left .mood {
  display: inline;
  font-size: 1.2rem;
}

/* Left-side container for mood/lock + date so mail icon can remain centered */
.card-left {
  display: flex;
  flex-direction: row;
  align-items: center;
  justify-content: center;
  gap: 8px;
  width: 100%;
}

/* For grid: position card-left at bottom center */
.items-list .journal-card .card-left {
  position: relative;
  left: auto;
  top: auto;
  transform: none;
  z-index: 1;
  gap: 8px;
  order: 3;
  flex-direction: row !important;
  width: auto;
  justify-content: center;
}

.journal-grid .journal-card {
  border: 1px solid #B8DB80 !important; 
  border-radius: 20px;
  min-height: 100px !important;
  max-width: 300px !important;  
  width: 100%;                  
  margin: auto;              
  padding: 10px !important;   
  display: flex;
  flex-direction: column;
  justify-content: center;     
  align-items: center;         
}

.journal-grid .card-body-wrapper {
  display: none !important; 
}

.journal-grid .card-top {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  width: 100%;
  gap: 5px;
  padding: 0;
}

.journal-grid .mail-icon-top {
  margin: 0 !important;
  padding: 0 !important;
  font-size: 5.5rem;
  line-height: 1;
  display: flex;
  justify-content: center;
  align-items: center;
}

.card-body-wrapper {
  position: relative;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 12px 12px 18px 12px;
  text-align: center;
  min-height: 56px;
}
.card-body {
  margin: 0;
  font-size: 0.95rem;
  color: rgba(0,0,0,0.65);
  line-height: 1.5;
  max-height: 6.5rem;
  overflow: hidden;
  text-overflow: ellipsis;
}

/* Make mail icon clickable */
.mail-icon-top { cursor: pointer; }

/* Modal overlay and journal note */
.modal-overlay {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.45);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 200;
}
.journal-modal {
  background: transparent;
  padding: 12px;
  border-radius: 12px;
}
.note-card {
  background: #fff8e8;
  border-radius: 12px;
  padding: 18px 22px;
  width: 320px;
  box-shadow: 0 8px 30px rgba(0,0,0,0.12);
  position: relative;
  text-align: center;
}
.note-emoji { font-size: 1.6rem; margin-bottom: 8px; }
.note-content { color: #5c4b40; font-size: 1rem; line-height: 1.6; }
.note-date { margin-top: 12px; font-size: 0.85rem; color: #8b7f76; }
.modal-close { position: absolute; right: -6px; top: -6px; background: white; border: 1px solid #eee; border-radius: 50%; width: 28px; height: 28px; cursor: pointer; }

.item-info.edit-mode {
  display: flex;
  flex-direction: column;
  gap: 10px;
  width: 100%;
}

.edit-input {
  width: 100%;
  border: 1px solid #ddd;
  background: white;
  padding: 10px 14px;
  border-radius: 12px;
  font-size: 1rem;
  font-family: inherit;
  color: var(--text);
  outline: none;
}

.edit-input:focus {
  border-color: var(--accent);
}

.edit-dates {
  display: flex;
  gap: 10px;
  flex-wrap: wrap;
}

.date-input-small {
  flex: 1;
  min-width: 120px;
  border: 1px solid #ddd;
  background: white;
  padding: 8px 12px;
  border-radius: 10px;
  font-family: inherit;
  font-size: 0.9rem;
  color: var(--text);
  outline: none;
  cursor: pointer;
}

.date-input-small:focus {
  border-color: var(--accent);
}

/* Checkbox มนกลม */
.circle-check { 
  width: 22px; 
  height: 22px; 
  cursor: pointer; 
  accent-color: var(--accent); 
  border-radius: 50%; /* มนกลม */
}

.text-area-cozy { width: 100%; height: 180px; border: none; background: #fafafa; border-radius: 18px; padding: 20px; outline: none; margin: 15px 0; font-family: inherit; font-size: 1.1rem; line-height: 1.6; color: var(--text); resize: none; }

.mood-strip { display: flex; gap: 12px; align-items: center; flex-wrap: wrap; margin-bottom: 15px; }
.mood-item { 
  background: white; border: 1px solid #eee; padding: 8px 14px; border-radius: 12px; cursor: pointer; font-size: 1.3rem; height: 44px; display: flex; align-items: center; transition: 0.2s; 
}
.mood-item.on { 
  background: var(--accent); color: white; border-color: var(--accent); transform: scale(1.05); 
}

.fortune-bubble {
  position: absolute; left: 70px; top: -10px; background: white; padding: 10px 15px;
  border-radius: 15px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); font-size: 0.8rem;
  width: 160px; z-index: 10; color: #5c4b40;
}

:root {
  --bg-app: #fcfaf7;
  --sidebar: #f1ede6;
  --text: #5c4b40;
  --accent: #e29a9a;
  --shadow: 0 10px 40px rgba(0,0,0,0.04);
  --prio-high: #ff9d9d;
  --prio-med: #ffd8a8;
  --prio-low: #e0e0e0;
}

.night-theme {
  --bg-app: #1a1c2c;
  --sidebar: #2a2d42;
  --text: #e0e0e0;
  --accent: #8e94f2;
}

/* --- Layout Structure --- */
.app-layout { display: flex; height: 100vh; padding: 12px; gap: 12px; background-color: var(--bg-app); transition: 0.5s; overflow: hidden; }

/* --- Sidebar: แก้ไขการเบียดและไอคอนไม่ตรง --- */
.sidebar {
  width: 260px; background-color: var(--sidebar); border-radius: 32px;
  display: flex; flex-direction: column; transition: width 0.4s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative; flex-shrink: 0; box-shadow: var(--shadow);
}
.sidebar-collapsed .sidebar { width: 88px; display: none; }

.sidebar-container {
  display: flex; flex-direction: column; height: 100%; padding: 30px 0;
  align-items: center; justify-content: flex-start; gap: 20px; /* เพิ่มระยะห่างระหว่างส่วน */
}

.sidebar-header-wrapper { width: 100%; display: flex; justify-content: center; }
.logo-section { display: flex; align-items: center; gap: 15px; cursor: pointer; min-width: 45px; }
.sidebar-expanded .logo-section { justify-content: flex-start; padding: 0 25px; width: 100%; }

.sidebar-float-toggle {
  background: white; border: 1px solid #e5e0d8; border-radius: 50%; width: 26px; height: 26px;
  cursor: pointer; position: absolute; right: -13px; top: 42px; z-index: 50;
  display: flex; align-items: center; justify-content: center; box-shadow: 0 2px 8px rgba(0,0,0,0.06);
}

.nav-list-cozy { width: 100%; display: flex; flex-direction: column; align-items: center; gap: 10px; }
.nav-item-pill {
  display: flex; align-items: center; padding: 14px 20px; border-radius: 20px; cursor: pointer;
  transition: 0.3s; color: var(--text); width: calc(100% - 24px); gap: 18px; box-sizing: border-box;
}
.sidebar-collapsed .nav-item-pill { justify-content: center; width: 56px; }

/* --- XP Bar Visual --- */
.xp-track-container { width: 100%; height: 8px; background: rgba(0, 0, 0, 0.05); border-radius: 10px; overflow: hidden; margin-top: 6px; }
.xp-bar-visual { height: 100%; background: var(--accent); transition: width 0.5s ease-out; border-radius: 10px; }

/* --- Missions & Diary Cards (แก้การเบียดใน Card) --- */
.input-wrapper-card { padding: 30px !important; display: flex; flex-direction: column; gap: 20px; }
.full-input-large { width: 100%; border: none; background: #fafafa; padding: 20px; border-radius: 20px; outline: none; font-size: 1.1rem; margin-bottom: 5px; }

.button-action-row { display: flex; justify-content: space-between; align-items: center; gap: 15px; flex-wrap: wrap; }
.pill-selector-flexible { display: flex; gap: 10px; background: rgba(0,0,0,0.03); padding: 8px; border-radius: 18px; flex-grow: 1; justify-content: center; }

.pill-btn-item {
  border: none; background: transparent; padding: 10px 22px; border-radius: 14px;
  cursor: pointer; transition: 0.2s; font-family: inherit; color: #888; white-space: nowrap;
}
.active-low { background: #e8f5e9; color: #4caf50; font-weight: bold; }
.active-medium { background: #fff3e0; color: #ff9800; font-weight: bold; }
.active-high { background: #ffebee; color: #f44336; font-weight: bold; }

/* --- To-Do Items Spacing --- */
.item-card { padding: 22px; border-radius: 24px; display: flex; justify-content: space-between; align-items: center; gap: 20px; }
.item-left { display: flex; align-items: center; gap: 18px; flex-grow: 1; }
.circle-check-large { width: 24px; height: 24px; cursor: pointer; accent-color: var(--accent); border-radius: 50%; }
.item-task-text { font-size: 1.05rem; line-height: 1.5; color: var(--text); }

/* --- Mood Strip Spacing --- */
.mood-strip-wide { display: flex; gap: 15px; align-items: center; flex-wrap: wrap; margin-bottom: 20px; }
.mood-dot-btn { background: white; border: 1px solid #eee; padding: 10px 16px; border-radius: 14px; font-size: 1.4rem; cursor: pointer; transition: 0.2s; }
.mood-dot-btn.on { background: var(--accent); color: white; border-color: var(--accent); transform: scale(1.08); }

/* --- Date Picker --- */
.date-picker-soft-rounded { border: 1px solid #eee; background: #fafafa; border-radius: 16px; padding: 10px 18px; font-family: inherit; outline: none; cursor: pointer; }

/* --- Button Colors --- */
.action-btn-primary, .action-btn-save-large {
  background: var(--accent); color: white; border: none; padding: 14px 28px;
  border-radius: 16px; font-weight: 700; cursor: pointer; transition: 0.25s; white-space: nowrap;
}
.action-btn-primary:hover { transform: translateY(-3px); box-shadow: 0 6px 15px rgba(226, 154, 154, 0.3); }

/* --- Delete Button --- */
.del-btn-soft { background: #fafafa; border: 1px solid #eee; color: #ccc; padding: 8px 18px; border-radius: 20px; cursor: pointer; font-size: 0.85rem; }
.del-btn-soft:hover { color: var(--accent); border-color: var(--accent); background: #fff; }

:root {
  --bg-app: #fcfaf7;
  --sidebar: #D2DCB6;
  --text: #5c4b40;
  --accent: #B8DB80;
  --shadow: 0 10px 40px rgba(0,0,0,0.04);
}

.night-theme {
  --bg-app: #1a1c2c;
  --sidebar: #2a2d42;
  --text: #e0e0e0;
  --accent: #8e94f2;
}

/* --- Layout --- */
.app-layout { display: flex; height: 100vh; padding: 12px; gap: 12px; background-color: var(--bg-app); transition: 0.5s; overflow: hidden; }

/* --- Sidebar --- */
.sidebar {
  width: 260px; background-color: var(--sidebar); border-radius: 32px;
  display: flex; flex-direction: column; transition: width 0.4s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative; flex-shrink: 0; box-shadow: var(--shadow);
}
.sidebar-collapsed .sidebar { width: 88px; }
.sidebar-container { 
  display: flex; 
  flex-direction: column; 
  height: 100%; 
  padding: 10px 0; 
  align-items: center;
  justify-content: flex-start;
  gap: 10px
 }
.logo-section { display: flex; align-items: center; gap: 12px; cursor: pointer; min-width: 40px; }
.brand-name { font-weight: 800; font-size: 1.1rem; color: var(--text); white-space: nowrap; }

/* --- Nav Items --- */
.nav-item-pill {
  display: flex; align-items: center; padding: 14px 20px; margin-bottom: 8px;
  border-radius: 20px; cursor: pointer; transition: 0.3s; color: var(--text);
  width: calc(100% - 24px); gap: 15px; box-sizing: border-box;
}
.sidebar-collapsed .nav-item-pill { justify-content: center; width: 54px; display: none; }
.nav-item-pill.active { background: white; box-shadow: 0 4px 15px rgba(0,0,0,0.03); font-weight: 700; }

/* --- Diary Buttons (แก้ไขสีเมื่อกดเลือก) --- */
.type-toggle { background: rgba(0,0,0,0.03); padding: 5px; border-radius: 16px; display: flex; gap: 5px; margin-bottom: 20px; }
.type-toggle .pill-btn { flex: 1; border-radius: 12px; padding: 10px; border: none; background: transparent; transition: 0.3s; cursor: pointer; }

.active-diary { background: #AEDEFC !important; box-shadow: 0 2px 10px rgba(0,0,0,0.05); font-weight: bold; }
.active-letter { background: #c6b5e8 !important; color: white !important; font-weight: bold; }

/* --- Textarea (แก้ไขขนาดและฟิกซ์) --- */
.text-area-cozy {
  width: 100%;
  min-height: 250px; /* ฟิกซ์ความสูงเริ่มต้นให้ใหญ่จุใจ */
  max-width: 100%; /* ล็อคไม่ให้ขยายเกินขอบด้านข้าง */
  padding: 20px;
  border: none;
  background: #fafafa;
  border-radius: 20px;
  font-family: inherit;
  font-size: 1.1rem;
  line-height: 1.7;
  color: var(--text);
  resize: vertical; /* อนุญาตให้ยืดลงล่างได้อย่างเดียว */
  outline: none;
  margin: 15px 0;
  display: block;
}

/* --- UI อื่นๆ --- */
.pill-selector { display: flex; gap: 8px; background: rgba(0,0,0,0.03); padding: 6px; border-radius: 16px; }
.pill-btn { border: none; background: transparent; padding: 8px 18px; border-radius: 12px; cursor: pointer; font-size: 0.9rem; transition: 0.2s; }
.active-low { background: #e8f5e9; color: #4caf50; font-weight: bold; }
.active-medium { background: #fff3e0; color: #ff9800; font-weight: bold; }
.active-high { background: #ffebee; color: #f44336; font-weight: bold; }

.main-content { flex: 1; background: white; border-radius: 32px; overflow: hidden; display: flex; flex-direction: column; box-shadow: var(--shadow); }
.cover-box { height: 260px; overflow: hidden; }
.cover-img { width: 100%; height: 100%; object-fit: cover; }
.scroll-area { flex: 1; overflow-y: auto; padding: 40px 10% 80px 10%; }
.cozy-card { background: #fff; border: 1px solid rgba(0,0,0,0.04); border-radius: 28px; padding: 24px; margin-bottom: 30px; }
.full-input { width: 100%; border: none; background: #fafafa; padding: 18px; border-radius: 18px; outline: none; font-size: 1.1rem; margin-bottom: 15px; }
.action-btn-main, .action-btn-save { background: var(--accent); color: white; border: none; padding: 12px 24px; border-radius: 14px; font-weight: 700; cursor: pointer; }
.item-card, .journal-card { 
  padding: 20px; 
  border-radius: 22px; 
  border: 3px solid #B8DB80; 
  margin-bottom: 12px; 
  background: #fff; 
  display: flex; 
  justify-content: space-between; 
  align-items: center; 
}
.circle-check { width: 22px; height: 22px; cursor: pointer; accent-color: var(--accent); }
.mood-strip { display: flex; gap: 12px; align-items: center; flex-wrap: wrap; margin-bottom: 15px; }
.mood-item { background: white; border: 1px solid #eee; padding: 8px 14px; border-radius: 12px; cursor: pointer; font-size: 1.3rem; height: 44px; display: flex; align-items: center; transition: 0.2s; }
.mood-item.on { background: var(--accent); color: white; border-color: var(--accent); transform: scale(1.05); }

.mood-save-btn {
  margin-left: auto;
  flex-shrink: 0;
  white-space: nowrap;
}

.header-with-date {
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  gap: 20px;
}

.today-date {
  background: rgba(226, 154, 154, 0.1);
  padding: 12px 20px;
  border-radius: 16px;
  font-size: 0.95rem;
  font-weight: 600;
  color: var(--accent);
  white-space: nowrap;
  min-width: fit-content;
}

.item-info {
  display: flex;
  flex-direction: column;
  gap: 6px;
  flex: 1;
}

.item-task {
  font-size: 1.05rem;
  line-height: 1.4;
  color: var(--text);
  font-weight: 500;
}

.item-dates {
  font-size: 0.85rem;
  color: #888;
  font-style: italic;
}

.item-dates-container {
  display: flex;
  flex-direction: column;
  gap: 4px;
}

.item-created {
  font-size: 0.8rem;
  color: #999;
  font-weight: 500;
}

.item-task-with-dates {
  display: flex;
  align-items: center;
  gap: 12px;
  flex-wrap: wrap;
}

.todo-container {
  display: flex;
  gap: 20px;
  align-items: flex-start;
}

.items-list {
  flex: 1;
  display: flex;
  flex-direction: column;
  gap: 12px;
}

.journal-grid {
  flex: 1;
  display: grid;
  grid-template-columns: repeat(4, 1fr); /* เรียง 4 คอลัมน์เหมือนเดิม */
  gap: 20px;
}

.journal-grid .journal-card .card-left {
  position: relative;
  display: flex;
  flex-direction: row !important;
  justify-content: center;
  width: auto;  
  gap: 8px;
  order: 3;
}

/* Responsive: 3 columns on tablet, 2 on mobile */
@media (max-width: 1200px) {
  .items-list {
    grid-template-columns: repeat(3, 1fr);
  }
}

@media (max-width: 768px) {
  .items-list {
    grid-template-columns: repeat(2, 1fr);
  }
}

@media (max-width: 480px) {
  .items-list {
    grid-template-columns: 1fr;
  }
}

.date-sidebar {
  width: 220px;
  flex-shrink: 0;
}

.date-section {
  display: flex;
  flex-direction: column;
  gap: 16px;
}

.item-dates-display {
  min-width: 200px;
  flex-shrink: 0;
  text-align: right;
}

.sidebar-float-toggle { position: absolute; right: -13px; top: 42px; width: 26px; height: 26px; background: white; border: 1px solid #eee; border-radius: 50%; cursor: pointer; z-index: 100; display: none; align-items: center; justify-content: center; box-shadow: 0 2px 8px rgba(0,0,0,0.06); }
.xp-track { width: 100%; height: 6px; background: rgba(0,0,0,0.05); border-radius: 10px; overflow: hidden; margin-top: 4px; }
.xp-bar { height: 100%; background: var(--accent); transition: 0.5s; }

/* Sidebar center area: fortune text + music player */
.sidebar-center {
  width: 100%;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 12px;
  padding: 12px 12px 18px 12px;
  box-sizing: border-box;
  margin-top: 20px;
}
.fortune-center {
  background: rgba(255,255,255,0.6);
  color: var(--text);
  padding: 10px 12px;
  border-radius: 12px;
  text-align: center;
  font-weight: 600;
  font-size: 0.95rem;
  width: 100%;
  box-shadow: 0 2px 8px rgba(0,0,0,0.03);
}
.music-player { width: 100%; display: flex; flex-direction: column; gap: 8px; }
.player-wrapper { width: 100%; border-radius: 12px; overflow: hidden; background: #000; }
.player-iframe { width: 100%; height: 140px; border: none; display: block; }
.track-info { display: flex; justify-content: space-between; align-items: center; padding: 8px 10px; background: rgba(0,0,0,0.03); border-radius: 10px; }
.track-title { font-size: 0.9rem; color: var(--text); font-weight: 700; }
.track-status { font-size: 0.8rem; color: #666; }

@media (max-width: 768px) {
  .player-iframe { height: 110px; }
  .fortune-center { font-size: 0.9rem; padding: 8px 10px; }
}

/* Hide sidebar center content when sidebar is collapsed on desktop */
.sidebar-collapsed .sidebar-center {
  display: none;
}

/* Ensure sidebar center shows when sidebar is explicitly opened (mobile toggle) */
.sidebar-toggle-visible .sidebar-center,
.sidebar .sidebar-open .sidebar-center,
.sidebar.sidebar-open .sidebar-center {
  display: flex !important;
}

/* --- Responsive: tablet and mobile --- */
@media (max-width: 1024px) {
  .scroll-area { padding: 30px 6% 60px 6%; }
  .cozy-card { padding: 18px; }
  .header-with-date { gap: 12px; }
  .today-date { font-size: 0.88rem; padding: 10px 14px; }
  .full-input { font-size: 1rem; padding: 14px; }
  .item-task { font-size: 1rem; }
  .item-dates { font-size: 0.8rem; }
  .mood-item { padding: 8px 12px; height: 40px; font-size: 1.15rem; }
}

@media (max-width: 768px) {
  /* Layout: sidebar collapse/hide */
  .sidebar { position: fixed; left: 0; top: 0; bottom: 0; z-index: 80; transform: translateX(-110%); transition: transform 0.28s ease; }
  .sidebar.sidebar-open { transform: translateX(0); }
  .sidebar-container { padding-top: 20px; }
  .app-layout.sidebar-open-main .sidebar { transform: translateX(0); }
  .main-content { margin-left: 0; }

  /* Stack input and buttons vertically */
  .input-row { flex-direction: column; align-items: stretch; }
  .input-row .action-btn-main { width: 100%; }
  .date-row { flex-direction: column; }
  .date-input { width: 100%; }

  /* Make pill selectors wrap and center */
  .button-row { display: flex; flex-direction: column; gap: 10px; }
  .pill-selector { justify-content: center; flex-wrap: wrap; }

  /* Items: increase touch target and stack */
  .item-card { padding: 16px; gap: 12px; }
  .item-left { gap: 12px; }
  .del-btn-pill { padding: 10px 14px; }

  /* Mood area */
  .mood-strip { gap: 10px; }
  .mood-save-btn { width: 100%; align-self: stretch; }

  /* Header: stack title and date */
  .header-with-date { flex-direction: column; align-items: flex-start; gap: 8px; }
  .today-date { align-self: flex-end; }

  /* Make fonts comfortable on mobile */
  .brand-name { font-size: 1rem; }
  .nav-item-pill { padding: 12px 14px; }
}

/* Utility: when JS toggles sidebar on mobile, add class to root */
.sidebar-toggle-visible .sidebar { transform: translateX(0) !important; }

/* Mobile overlay and menu button */
.mobile-overlay {
  display: none;
}
.mobile-overlay.visible {
  display: block;
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.45);
  z-index: 70;
}

.mobile-menu-btn {
  display: none;
  position: fixed;
  top: 14px;
  left: 14px;
  z-index: 90;
  background: rgba(255,255,255,0.95);
  border: 1px solid rgba(0,0,0,0.06);
  padding: 8px 12px;
  border-radius: 10px;
  font-size: 1.1rem;
  cursor: pointer;
}

@media (max-width: 768px) {
  .mobile-menu-btn { display: block; }
}

/* --- Login Screen --- */
.login-screen {
  height: 100vh;
  display: flex;
  align-items: center;
  justify-content: center;
  background-color: #fcfaf7;
}

.login-card {
  text-align: center;
  background: white;
  padding: 50px;
  border-radius: 40px;
  box-shadow: 0 20px 60px rgba(0,0,0,0.05);
  max-width: 400px;
  width: 90%;
}

.login-btn {
  margin-top: 25px;
  width: 100%;
  font-size: 1.1rem;
  padding: 16px;
}

/* --- User Profile in Sidebar --- */
.user-profile-lite {
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 0 20px;
  margin-bottom: 25px;
  width: 100%;
}

.user-avatar {
  width: 42px;
  height: 42px;
  border-radius: 50%;
  border: 2px solid white;
}

.user-info {
  display: flex;
  flex-direction: column;
}

.user-name {
  font-weight: 700;
  font-size: 0.9rem;
  color: var(--text);
}

.logout-link {
  background: none;
  border: none;
  color: var(--accent);
  font-size: 0.75rem;
  cursor: pointer;
  padding: 0;
  text-align: left;
  text-decoration: underline;
}

/* --- Overdue Styling --- */
.overdue-text {
  color: #ff4d4d !important;
  font-weight: 800 !important;
  animation: shake 0.5s ease-in-out;
}

@keyframes shake {
  0%, 100% { transform: translateX(0); }
  25% { transform: translateX(-2px); }
  75% { transform: translateX(2px); }
}

/* --- Item Card Done State --- */
.item-card.done {
  opacity: 0.6;
  filter: grayscale(0.5);
}

.item-card.done .item-task {
  text-decoration: line-through;
}

/* Profile Minimal Style */
.user-profile-minimal {
  position: relative;
  display: flex;
  justify-content: center;
  padding: 20px 0;
  margin-bottom: 10px;
}

.avatar-wrapper {
  position: relative;
  cursor: pointer;
}

.user-avatar-only {
  width: 50px;
  height: 50px;
  border-radius: 50%;
  border: 3px solid #fff;
  box-shadow: 0 4px 15px rgba(0,0,0,0.1);
  transition: transform 0.3s ease;
}

.user-avatar-only:hover {
  transform: scale(1.1);
}

.user-dropdown {
  position: absolute;
  top: 60px;
  left: 0;
  background: white;
  min-width: 150px;
  border-radius: 15px;
  box-shadow: 0 10px 25px rgba(0,0,0,0.1);
  z-index: 100;
  padding: 10px 0;
  overflow: hidden;
}

.dropdown-item {
  padding: 10px 20px;
  font-size: 0.85rem;
  width: 100%;
  text-align: left;
  border: none;
  background: none;
  display: block;
}

.user-display-name {
  font-weight: bold;
  color: #888;
}

.logout-btn-red {
  color: #ff4d4d;
  cursor: pointer;
}

.logout-btn-red:hover {
  background: #fff5f5;
}

.fade-in {
  animation: fadeIn 0.2s ease-out;
}

@keyframes fadeIn {
  from { opacity: 0; transform: translateY(-10px); }
  to { opacity: 1; transform: translateY(0); }
}

.logout-link-container {
  margin-top: 5px;
  display: flex;
  justify-content: center;
  width: 100%;
  padding-bottom: 0px;
}

.logout-text-link {
  color: #2d5a27; /* สีเขียวเข้ม */
  text-decoration: underline;
  font-size: 0.85rem;
  cursor: pointer;
  font-weight: 500;
  transition: opacity 0.2s;
}

.logout-text-link:hover {
  opacity: 0.7;
}
/* No Image UI */
.no-img-icon {
  width: 100%;
  height: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 2.5rem;
  color: rgba(0,0,0,0.1); /* สีจางๆ */
  background: #f0f0f0;
}

.no-img-icon-mini {
  width: 100%;
  height: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 1.5rem;
  color: rgba(0,0,0,0.1);
  background: #f5f5f5;
}

/* ปรับ Grid ให้เล็กลงครึ่งหนึ่ง (แสดงประมาณ 6-8 คอลัมน์) */
.library-grid-mini {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(140px, 1fr)); /* ขนาดเล็กลง */
  gap: 12px;
  padding: 10px 0;
}

.library-card-mini {
  background: white;
  border-radius: 16px;
  border: 2px solid #D2DCB6;
  overflow: hidden;
  transition: transform 0.2s;
  display: flex;
  flex-direction: column;
}

.library-card-mini:hover { transform: translateY(-3px); }

.lib-img-mini { width: 100%; overflow: hidden; background: #eee; }
.lib-img-mini img { width: 100%; height: 100%; object-fit: cover; }

.lib-content-mini { padding: 10px; flex: 1; display: flex; flex-direction: column; gap: 4px; }
.lib-mini-header { display: flex; justify-content: space-between; align-items: flex-start; }
.truncate-mini { font-size: 0.9rem; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 80px; }

.lib-mini-actions { display: flex; gap: 6px; cursor: pointer; font-size: 0.8rem; opacity: 0.6; }
.lib-mini-actions span:hover { opacity: 1; transform: scale(1.1); }

.stars-mini { font-size: 0.7rem; color: #ffcc00; }
.price-mini { font-size: 0.85rem; font-weight: bold; color: var(--accent); }
.loc-mini { font-size: 0.75rem; color: #888; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }

/* Responsive */
@media (max-width: 600px) {
  .library-grid-mini { grid-template-columns: repeat(2, 1fr); }
}
.lib-form-flex { display: flex; gap: 20px; align-items: flex-start; }
.lib-image-preview { width: 120px; height: 160px; border-radius: 12px; background: #eee; overflow: hidden; flex-shrink: 0; }
.lib-image-preview img { width: 100%; height: 100%; object-fit: cover; }
.lib-inputs { flex: 1; }

/* Grid 4 Columns */
.library-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 15px; }

/* Aspect Ratios */
.lib-card-img-container { width: 100%; overflow: hidden; background: #f9f9f9; }
.ratio-3-4 { aspect-ratio: 3/4; }
.ratio-16-9 { aspect-ratio: 16/9; }
.lib-card-img-container img { width: 100%; height: 100%; object-fit: cover; }

.lib-card-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 5px; }
.truncate { white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 140px; display: block; }
.lib-dump-text { font-size: 0.85rem; color: #777; line-height: 1.4; height: 4.2em; overflow: hidden; display: -webkit-box; -webkit-line-clamp: 3; -webkit-box-orient: vertical; margin-top: 8px; }
.lib-price-text { color: var(--accent); font-weight: bold; font-size: 0.95rem; }
.lib-location-text { font-size: 0.85rem; color: #888; margin-top: 5px; }
.library-grid {
  display: grid;
  grid-template-columns: repeat(4, 1fr); /* บังคับ 4 คอลัมน์ */
  gap: 20px;
  margin-top: 20px;
}

.library-card {
  background: white;
  border-radius: 20px;
  border: 2px solid #D2DCB6; /* สีโทนเขียวอ่อนตามธีมคุณ */
  overflow: hidden;
  transition: transform 0.3s ease;
  display: flex;
  flex-direction: column;
}

.library-card:hover {
  transform: translateY(-5px);
}

.library-card-img {
  width: 100%;
  height: 180px;
  object-fit: cover;
}

.library-card-content {
  padding: 15px;
}

.active-library-sub {
  background: #B8DB80 !important; /* สีเขียว Accent ของคุณ */
  color: white !important;
  font-weight: bold;
}
.library-visual-section {
  display: flex;
  align-items: flex-end;
  gap: 30px;
  margin-bottom: 40px;
  padding: 20px;
  background: #fdfaf5;
  border-radius: 20px;
  justify-content: center;
}

/* ชั้นหนังสือ */
.shelf-display-container {
  width: 350px;
  height: 550px;
  background-size: 100% 100%;
  background-repeat: no-repeat;
  position: relative;
  box-shadow: 0 10px 30px rgba(0,0,0,0.1);
  border-radius: 10px;
}

.shelf-grid-overlay {
  position: absolute;
  top: 0; left: 0; right: 0; bottom: 0;
}

.book-on-shelf {
  position: absolute;
  height: 75px; /* ปรับความสูงสันหนังสือให้เหมาะกับช่องว่างชั้น */
  width: auto;
  transition: transform 0.2s;
  cursor: help;
}
.book-on-shelf:hover { transform: scale(1.1) translateY(-5px); z-index: 100; }

/* กองดองซ้อนกัน */
.tbr-stack-visual {
  position: relative;
  width: 150px;
  height: 300px;
  display: flex;
  flex-direction: column;
  align-items: center;
}

.tbr-stacked-book {
  position: absolute;
  width: 120px;
  transition: all 0.3s;
}

.tbr-stacked-book img {
  width: 100%;
  filter: drop-shadow(0 2px 4px rgba(0,0,0,0.1));
}

.tbr-stacked-book:hover {
  transform: translateX(10px);
  cursor: help;
}

.tbr-tooltip {
  visibility: hidden;
  position: absolute;
  left: 100%;
  background: #5c4b40;
  color: white;
  padding: 5px 10px;
  border-radius: 5px;
  font-size: 12px;
  white-space: nowrap;
  margin-left: 10px;
  z-index: 200;
}
.tbr-stacked-book:hover .tbr-tooltip { visibility: visible; }
.tbr-label {
  position: absolute;
  bottom: -30px;
  font-weight: bold;
  color: #8b7355;
  font-size: 14px;
}
/* Library Visual Layout */
.library-visual-wrapper {
  display: flex;
  justify-content: center;
  align-items: flex-end;
  gap: 40px;
  padding: 40px 20px;
  background: #fdfaf5;
  border-radius: 24px;
  margin-bottom: 30px;
}

/* Bookshelf Display */
.bookshelf-container {
  width: 320px; /* ปรับตามขนาดรูปพื้นหลัง */
  height: 520px;
  background-image: url('https://path-to-your-uploaded/Bookshelf_background.jpg');
  background-size: 100% 100%;
  position: relative;
  box-shadow: 0 10px 30px rgba(0,0,0,0.08);
}

.shelf-books-grid {
  position: absolute;
  top: 0; left: 0; width: 100%; height: 100%;
}

.spine-on-shelf {
  position: absolute;
  height: 65px; /* ขนาดไอคอนสันหนังสือแนวตั้ง */
  width: auto;
  transition: transform 0.2s;
  cursor: pointer;
}
.spine-on-shelf:hover { transform: scale(1.1) translateY(-5px); z-index: 10; }

/* TBR Stack Display */
.tbr-stack-container {
  position: relative;
  width: 140px;
  height: 350px;
  display: flex;
  flex-direction: column;
  align-items: center;
}

.tbr-horizontal-book {
  position: absolute;
  width: 130px; /* ขนาดรูปกองดองแนวนอน */
  transition: all 0.3s;
}
.tbr-horizontal-book img {
  width: 100%;
  filter: drop-shadow(0 3px 6px rgba(0,0,0,0.1));
}

.tbr-count-tag {
  position: absolute;
  bottom: -30px;
  font-size: 0.85rem;
  font-weight: bold;
  color: #8b7355;
  background: #fff;
  padding: 4px 12px;
  border-radius: 20px;
  box-shadow: 0 2px 8px rgba(0,0,0,0.05);
}